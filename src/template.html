<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>$TITLE</title>

    <style>
        :root {
            font-size: 15px;
        }

        body,
        html {
            margin: 0;
            padding: 0;
        }

        article {
            max-width: 70ch;
            padding: 30px;

            margin: auto;
            font-family: serif;

            padding-top: 60px;
            padding-bottom: 200px;
        }

        article p,
        article li {
            line-height: 1.7rem;
            font-size: 1.1rem;
        }

        article li {
            list-style-type: bengali;
        }

        article ul {
            padding: 7px;
        }

        article h1,
        article h2,
        article h3,
        article h4,
        article h5,
        article h6 {
            font-family: sans-serif;
        }

        article h1 {
            font-size: 2rem;
            padding-bottom: 10px;
            border-bottom-width: 1px;
            border-bottom-style: solid;
        }

        article h2 {
            font-size: 1.7rem;
        }

        article pre {
            font-size: 0.9rem;
            padding: 20px 0;
            overflow-x: auto;
        }

        article a {
            text-decoration: none;
            padding-left: 5px;
            display: block;
            font-family: sans-serif;
        }

        header {
            width: 100%;
            height: 80px;
        }

        .header-content {
            height: 50px;
            line-height: 50px;
            position: relative;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 70ch;
        }

        .icon {
            display: inline;
            image-rendering: crisp-edges;
        }

        .header-content a {
            font-size: 1.6rem;
            text-transform: uppercase;
            font-family: sans-serif;
            text-decoration: none;
            float: right;
        }

        .header-content.js-disabled a {
            text-align: center;
            float: inherit;
            width: 100%;
            display: block;
        }

        @media screen and (max-width: 70ch) {
            .header-content {
                max-width: calc(70ch - 250px);
            }
        }

        @media (prefers-color-scheme: light) {
            header {
                background-color: #f9f5d7;
            }

            .header-content a {
                color: #7c6f64;
            }

            body {
                background-color: #fbf1c7;
                color: #3c3836;
            }

            article pre {
                scrollbar-color: #7c6f64 #f9f5d7;
            }

            article a {
                color: #458588;
            }

            article a:visited {
                color: #b16286;
            }

            article h1 {
                border-color: #3c383611;
            }
        }

        @media (prefers-color-scheme: dark) {
            header {
                background-color: #1d2021;
            }

            .header-content a {
                color: #a89984;
            }

            body {
                background-color: #282828;
                color: #ebdbb2;
            }

            article pre {
                scrollbar-color: #a89984 #282828;
            }

            article a {
                color: #458588;
            }

            article a:visited {
                color: #b16286;
            }

            article h1 {
                border-color: #ebdbb211;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="header-content js-disabled">
            <a href="/">$HOSTNAME</a>
        </div>
    </header>

    <article>$CONTENT</article>

    <script>
        const darkColours = [
            "#fb4934",
            "#b8bb26",
            "#fabd2f",
            "#83a598",
            "#d3869b",
            "#8ec07c",
            "#d65d0e",
        ];
        const darkBg = "#1d2021";

        const lightColours = [
            "#9d0006",
            "#79740e",
            "#b57614",
            "#076678",
            "#8f3f71",
            "#427b58",
            "#d65d0e",
        ];
        const lightBg = "#f9f5d7";


        const size = 50;
        const cells = 5;

        function hashString(str) {
            let hash = 2166136261;
            for (let i = 0; i < str.length; i++) {
                hash ^= str.charCodeAt(i);
                hash = Math.imul(hash, 16777619);
            }
            return hash >>> 0;
        }

        function mulberry32(a) {
            return function () {
                a |= 0;
                a = a + 0x6D2B79F5 | 0;
                let t = Math.imul(a ^ a >>> 15, 1 | a);
                t ^= t + Math.imul(t ^ t >>> 7, 61 | t);
                return ((t ^ t >>> 14) >>> 0) / 4294967296;
            };
        }

        function createIdenticon(bg, colours, seed) {
            const seedHash = hashString(seed);
            const rand = mulberry32(seedHash);

            const canvas = document.createElement("canvas");
            canvas.width = size;
            canvas.height = size;
            const ctx = canvas.getContext("2d");

            ctx.fillStyle = bg;
            ctx.fillRect(0, 0, size, size);

            const cellSize = size / cells;
            const half = Math.ceil(cells / 2);

            const columnColors = Array.from({ length: half }, () =>
                colours[Math.floor(rand() * colours.length)]
            );

            for (let y = 0; y < cells; y++) {
                for (let x = 0; x < half; x++) {
                    if (rand() > 0.5) {
                        const mirrorX = cells - x - 1;

                        ctx.fillStyle = columnColors[x];

                        ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize);
                        ctx.fillRect(mirrorX * cellSize, y * cellSize, cellSize, cellSize);
                    }
                }
            }

            return canvas;
        }

        function drawIdenticon(bg, colours) {
            const existingIdenticon = document.querySelector(".icon");
            if (existingIdenticon) {
                existingIdenticon.remove();
            }

            const identicon = createIdenticon(bg, colours, location.hostname);
            identicon.classList.add("icon");
            const iconContainer = document.querySelector(".header-content");
            iconContainer.classList.remove("js-disabled");
            iconContainer.insertAdjacentElement("afterbegin", identicon);
        }

        const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
        function updateColours(e) {
            if (e.matches) drawIdenticon(darkBg, darkColours);
            else           drawIdenticon(lightBg, lightColours);
        }
        mediaQuery.addEventListener('change', updateColours);
        updateColours(mediaQuery);

        const header = document.querySelector("header");
        header.addEventListener("click", () => location.href = "/");
        header.style.cursor = "pointer";
    </script>
</body>

</html>
